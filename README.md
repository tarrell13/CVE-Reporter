## Synopsis:

Program searches Nessus instance for CVE relative plugins. Performs a remediation
check to determine if plugins fired in scan results and outputs data. 

## Installation:

Program makes use of the Python2.7 engine
```
# pip install -r requirements
```

## Usability:

###### Config File MODE 

The example below shows the program operating in config mode, which takes json
formated file based on the "template_config.txt" file. Recursively queries Nessus
instance based on configuration settings to match CVE items to specified scan ID.

Program will also output a "cve_parse.save" so you can resume operations if program is cancelled for whatever
reasons by specifying the "-r/--resume" switch and specifying the "cve_parse.save" file. 

```
[user@localhost]$ python cve_reporter.py --config test_config.txt 
  _____________   _______________ __________                             __		 
  \_   ___ \   \ /   /\_   _____/ \______   \ ____ ______   ____________/  |_  ___________  
  /    \  \/\   Y   /  |    __)_   |       _// __ \\____ \ /  _ \_  __ \   __\/ __ \_  __ \
  \     \____\     /   |        \  |    |   \  ___/|  |_> >  <_> )  | \/|  | \  ___/|  | \/ 
   \______  / \___/   /_______  /  |____|_  /\___  >   __/ \____/|__|   |__|  \___  >__|    
          \/                  \/          \/     \/|__|                           \/        

[*] Login Successful

[+] Parsing each plugin for possible match on CVEs for CVE FILE: 2017-A-0010
[============================================================] 100.0% ...

[+] Downloading Scan Data
[+] Retrieving Host Data from Scan
[+] Searching Scan Results for Matches
[============================================================] 100.0% ...
[+] Filename: output-scan-3.json written


[+] Parsing each plugin for possible match on CVEs for CVE FILE: 2016-A-0181
[============================================================] 100.0% ...

[+] Downloading Scan Data
[+] Retrieving Host Data from Scan
[+] Searching Scan Results for Matches
[============================================================] 100.0% ...
[+] Filename: output-scan-1.json written


[+] Parsing each plugin for possible match on CVEs for CVE FILE: 2017-A-0021
[============================================================] 100.0% ...

[+] Downloading Scan Data
[+] Retrieving Host Data from Scan
[+] Searching Scan Results for Matches
[============================================================] 100.0% ...
[+] Filename: output-scan-2.json written

[+] Performing Remediation Check
[+] Filename: remediation_check_output-scan-3.json written
[+] Filename: remediation_check_output-scan-1.json written
[+] Filename: remediation_check_output-scan-2.json written

```
----

###### SINGLE ID MODE

This mode only takes in an input file with the CVEs you want to parse for and
the output filename. The program will only search this scan results for relevant 
plugins.

```
[user@localhost]$ python cve_reporter.py --input 2016-A-0181.txt --write single_id_mode.json
  _____________   _______________ __________                             __		 
  \_   ___ \   \ /   /\_   _____/ \______   \ ____ ______   ____________/  |_  ___________  
  /    \  \/\   Y   /  |    __)_   |       _// __ \\____ \ /  _ \_  __ \   __\/ __ \_  __ \
  \     \____\     /   |        \  |    |   \  ___/|  |_> >  <_> )  | \/|  | \  ___/|  | \/ 
   \______  / \___/   /_______  /  |____|_  /\___  >   __/ \____/|__|   |__|  \___  >__|    
          \/                  \/          \/     \/|__|                           \/        

[*] Login Successful
[+] Select Scan ID: 331

[+] Parsing each plugin for possible match on CVEs
[============================================================] 100.0% ...

[+] Downloading Scan Data
[+] Retrieving Host Data from Scan
[+] Searching Scan Results for Matches
[============================================================] 100.0% ...
[+] Filename: single_id_mode.json written

[+] Performing Remediation Check
[+] Filename: remediation_check_single_id_mode.json written

```

## INPUT FILE EXAMPLES

###### CVE INPUT FILE

CVE Files need to only have the CVEs, which are then placed on their own line.

```
[user@localhost Loader]$ cat cve_list.txt 
cve-2017-11108
cve-2017-13002
cve-2017-13044
```

###### CONFIG Example

Config file needs to be in json format 

```
[user@localhost]$ cat test_config.txt 
{
	"SCAN-1" : {
		"id": "338",
		"output": "output-scan-1.json",
		"input":  "./cve_list_1.txt"
			},

	"SCAN-2" : {
		"id": "331",
		"output": "output-scan-2.json",
		"input": "cve_list_2.txt"
		},

	"SCAN3" : {
		"id": "338",
		"output" : "output-scan-3.json",
		"input" : "/path/to/cve_list_3.txt"
		}

}

```
## READING OUTPUT:

1) After the program runs you should be given 2 output files for each scan ID. 
    a. Remediation Check output
    b. Actual results for parse

2) You will want to check the Remediation check first to determine if you need to
check the actual results. The remediation check searches output and determine
if hosts are flagged for the selected plugins under the CVEs. If the host is 
listed, then this means the plugin fired in the scan, which indicates an open finding.

```
[user@localhost]$ cat remediation_check_output-scan-1.json 
######################
# Remediation Check  #
######################

CVE-2016-3238 => FAIL
CVE-2016-3239 => PASS
```

3) If the remediation check shows failed, then you will want to check the results
to see, which plugins fired and host that are affected. Program is outputted in json
format to read the data easier in a program such as notepad++.

```
[user@localhost]$ cat output-scan-1.json 
{
    "CVE-2016-3238": {
        "92018": {
            "hosts": [10.10.10.5, 10.10.10.4], 
            "name": "MS16-087: Security Update for Windows Print Spooler (3170005)"
        }
    }, 
    "CVE-2016-3239": {
        "92018": {
            "hosts": [], 
            "name": "MS16-087: Security Update for Windows Print Spooler (3170005)"
        }
    }

```




